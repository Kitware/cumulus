[backend]
precision = double
rank-allocator = linear

[constants]
gamma = 1.4
mu = 0.417
Pr = 0.72
cp = 1005.0
Uw = 70
H = 1.0
Pc = 100000.0
Tw = 300.0

[solver]
system = navier-stokes
order = 2
viscosity-correction = none
shock-capturing = none

[solver-time-integrator]
scheme = rk4
tstart = 0
tend = 0.02
dt = 0.00004
controller = none

[solver-interfaces]
riemann-solver = rusanov
ldg-beta = 0.5
ldg-tau = 0.1

[solver-interfaces-line]
flux-pts = gauss-legendre

[solver-elements-tri]
soln-pts = williams-shunn
doc
[solver-elements-quad]
soln-pts = gauss-legendre

[soln-plugin-nancheck]
nsteps = 50

[soln-plugin-writer]
dt-out = 0.02
basedir = .
basename = couette_flow_2d-{n:03d}

[soln-ics]
rho = 4*(Pc*sqrt(Pr*(Pr*Uw*Uw+8*cp*Tw))*log((sqrt(Pr*(Pr*Uw*Uw+8*cp*Tw))+Pr*Uw)/(sqrt(Pr*(Pr*Uw*Uw+8*cp*Tw))-Pr*Uw))*gamma)/(Pr*Uw*(Pr*Uw*Uw+8*cp*Tw)*(gamma-1))
u = Uw
v = 0.0
p = Pc

[soln-bcs-bcwallupper]
u = Uw
cpTw = cp*Tw
type = no-slp-isot-wall

[soln-bcs-bcwalllower]
cpTw = cp*Tw
type = no-slp-isot-wall

[backend-openmp]
cblas = /usr/lib/openblas-base/libblas.so

